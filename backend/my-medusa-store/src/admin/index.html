<!DOCTYPE html>
<html>
    <head>
        <meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
        <meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=no" />
        <title>marqasouq Admin</title>
        <link rel="icon" type="image/svg+xml" href="data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 100 100'%3E%3Cdefs%3E%3ClinearGradient id='grad' x1='0%25' y1='0%25' x2='100%25' y2='100%25'%3E%3Cstop offset='0%25' style='stop-color:%23E63946'/%3E%3Cstop offset='100%25' style='stop-color:%23C62828'/%3E%3C/linearGradient%3E%3C/defs%3E%3Ccircle cx='50' cy='50' r='45' fill='url(%23grad)'/%3E%3Ctext x='50' y='65' font-family='Arial,sans-serif' font-size='40' font-weight='bold' fill='white' text-anchor='middle'%3EM%3C/text%3E%3C/svg%3E" />
        <style>
            /* MARQA SOUQ BRANDING - Dark Theme */
            :root {
                --marqa-primary: #E63946;
                --marqa-primary-dark: #C62828;
                --marqa-secondary: #1D3557;
                --marqa-dark: #0D1B2A;
                --marqa-gradient: linear-gradient(135deg, #E63946 0%, #C62828 100%);
            }
            
            /* Dark neutral background - NO BLUE */
            body {
                background: #0d0f12 !important;
                min-height: 100vh;
            }
            
            /* Sidebar - dark neutral */
            aside,
            nav,
            [class*="Sidebar"],
            [class*="sidebar"],
            .bg-ui-bg-subtle {
                background: #111318 !important;
                background-image: none !important;
            }
            
            /* Login card - DARK panel */
            .bg-ui-bg-base {
                background: rgba(22, 24, 29, 0.95) !important;
                color: #E6EEF8 !important;
                backdrop-filter: blur(6px) !important;
                border-radius: 16px !important;
                box-shadow: 0 25px 50px -12px rgba(0, 0, 0, 0.6) !important;
                border: 1px solid rgba(255,255,255,0.04) !important;
            }

            /* Hide default SVG logo inside the login area (force removal so our logo shows) */
            [data-testid="login-card"] svg,
            [data-testid="login-card"] img,
            main > div > div:first-child svg,
            main > div > div:first-child img {
                display: none !important;
                opacity: 0 !important;
                width: 0 !important;
                height: 0 !important;
            }

            /* Inserted logo wrapper (we will inject this via script) */
            .marqa-inserted-logo {
                display: flex;
                justify-content: center;
                align-items: center;
                margin-bottom: 1rem;
            }

            .marqa-inserted-logo .marqa-logo-icon {
                width: 84px;
                height: 84px;
                border-radius: 20px;
                display:flex;
                align-items:center;
                justify-content:center;
                background: var(--marqa-gradient);
                box-shadow: 0 12px 30px rgba(230,57,70,0.25);
            }

            .marqa-inserted-logo .marqa-logo-icon span {
                color: white;
                font-size: 2.2rem;
                font-weight: 800;
            }
            
            /* Submit button */
            button[type="submit"] {
                background: var(--marqa-gradient) !important;
                border: none !important;
                font-weight: 600 !important;
                box-shadow: 0 4px 15px rgba(230, 57, 70, 0.3) !important;
                transition: all 0.3s ease !important;
            }
            
            button[type="submit"]:hover {
                transform: translateY(-2px) !important;
                box-shadow: 0 8px 25px rgba(230, 57, 70, 0.4) !important;
            }
            
            /* Input styling for dark panel */
            input, textarea, select {
                background: rgba(255,255,255,0.02) !important;
                color: #E6EEF8 !important;
                border: 1px solid rgba(255,255,255,0.06) !important;
                padding: 10px 12px !important;
                border-radius: 8px !important;
            }

            /* Input focus */
            input:focus, textarea:focus, select:focus {
                border-color: var(--marqa-primary) !important;
                box-shadow: 0 0 0 3px rgba(230, 57, 70, 0.12) !important;
                outline: none !important;
            }

            ::placeholder {
                color: rgba(230,230,230,0.4) !important;
            }
            
            /* Reset link */
            a[href*="reset"] {
                color: var(--marqa-primary) !important;
            }
            
            /* Active nav items */
            nav a[aria-current="page"],
            [data-active="true"] {
                background: rgba(230, 57, 70, 0.1) !important;
                border-left-color: var(--marqa-primary) !important;
            }
            
            /* Checkboxes */
            input[type="checkbox"]:checked {
                background-color: var(--marqa-primary) !important;
                border-color: var(--marqa-primary) !important;
            }
            
            /* Custom logo container */
            .marqa-logo {
                display: flex;
                flex-direction: column;
                align-items: center;
                margin-bottom: 1.5rem;
            }
            
            .marqa-logo-icon {
                width: 80px;
                height: 80px;
                background: var(--marqa-gradient);
                border-radius: 20px;
                display: flex;
                align-items: center;
                justify-content: center;
                box-shadow: 0 10px 30px rgba(230, 57, 70, 0.3);
                margin-bottom: 1rem;
            }
            
            .marqa-logo-icon span {
                color: white;
                font-size: 2.5rem;
                font-weight: 800;
            }
            
            .marqa-brand-text {
                font-size: 1.75rem;
                font-weight: 800;
                background: var(--marqa-gradient);
                -webkit-background-clip: text;
                -webkit-text-fill-color: transparent;
                background-clip: text;
                letter-spacing: 2px;
            }
            
            .marqa-tagline {
                color: #64748b;
                font-size: 0.875rem;
                margin-top: 0.25rem;
            }
        </style>
    </head>
    <body>
        <div id="medusa"></div>
        <script type="module" src="./entry.jsx"></script>
        <script>
            // Marqa Souq Branding Script
            function applyMarqaBranding() {
                const isLoginPage = window.location.pathname.includes('/login');
                
                if (isLoginPage) {
                    // (heading/subtitle replacement is handled below in a single, robust pass)
                    
                    // Insert a custom logo element into the login card (more robust)
                    const loginCard = document.querySelector('[data-testid="login-card"]') || document.querySelector('main > div > div:first-child');
                    if (loginCard && !loginCard.querySelector('.marqa-inserted-logo')) {
                        const logoWrap = document.createElement('div');
                        logoWrap.className = 'marqa-inserted-logo';
                        logoWrap.innerHTML = `
                            <div class="marqa-logo-icon">
                                <span>M</span>
                            </div>
                        `;
                        // Insert logo at the top of the card
                        const firstChild = loginCard.firstElementChild;
                        if (firstChild) {
                            loginCard.insertBefore(logoWrap, firstChild);
                        } else {
                            loginCard.prepend(logoWrap);
                        }
                    }

                    // More robust heading replacement: replace any heading containing 'Welcome' or 'Medusa'
                    const headings = document.querySelectorAll('h1, h2, [class*="Heading"], [role="heading"]');
                    headings.forEach(h => {
                        if (h.textContent && (/Welcome|Medusa/i).test(h.textContent)) {
                            h.textContent = 'Welcome to Marqasouq';
                            h.style.cssText = 'font-size:1.75rem;font-weight:700;color:#e6eef8;';
                        }
                    });

                    // Subtitle replacement - check for 'Sign in' variants
                    const paragraphs = document.querySelectorAll('p, div');
                    paragraphs.forEach(p => {
                        if (p.textContent && (/Sign in|Sign into|Sign into|Sign into the account|Sign in to access/i).test(p.textContent)) {
                            p.innerHTML = '<span class="marqa-tagline">مرقة سوق • Your Premium Marketplace</span>';
                        }
                    });

                    // Insert 'Extras' link under Banners in the left sidebar
                    try {
                        const navLinks = Array.from(document.querySelectorAll('nav a, nav button'));
                        const banners = navLinks.find(n => n.textContent && n.textContent.trim().toLowerCase().includes('banners')) || null;
                        if (banners) {
                            const bannersWrapper = banners.closest('li') || banners.parentElement;
                            if (bannersWrapper && !bannersWrapper.parentElement.querySelector('.marqa-sidebar-item')) {
                                const li = document.createElement('div');
                                li.className = 'marqa-sidebar-item';
                                li.innerHTML = '<span class="dot"></span><span>Extras</span>';
                                li.style.cursor = 'pointer';
                                li.addEventListener('click', function(){ window.location.href = '/app/extras'; });
                                bannersWrapper.parentElement.insertBefore(li, bannersWrapper.nextSibling);
                            }
                        }
                    } catch (e) {
                        // ignore
                    }
                }
                
                // Update page title
                if (document.title.includes('Medusa')) {
                    document.title = document.title.replace('Medusa', 'marqasouq');
                }
            }
            
            // Run when DOM is ready and on mutations
            if (document.readyState === 'loading') {
                document.addEventListener('DOMContentLoaded', applyMarqaBranding);
            } else {
                applyMarqaBranding();
            }
            
            // Watch for dynamic content changes (React renders)
            const observer = new MutationObserver(() => {
                applyMarqaBranding();
            });
            
            observer.observe(document.body || document.documentElement, {
                childList: true,
                subtree: true
            });
        </script>
    </body>
</html>
